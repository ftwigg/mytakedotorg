plugins { id 'org.inferred.processors' version '1.2.15' }

apply plugin: 'java'

repositories {
	mavenCentral()
	maven { url 'http://repository.jsweet.org/artifactory/libs-release-local' }
}
dependencies {
	processor 'com.google.auto.value:auto-value:1.5.4'

	compileOnly 'com.google.code.findbugs:jsr305:3.0.0'
	compile project(':client')
	compile "com.jsoniter:jsoniter:$JSONITER_VER"
	compile "org.jsweet:jsweet-core:$JSWEET_CORE_VER"
	compile 'org.jsoup:jsoup:1.11.2'
	compile 'org.eclipse.jgit:org.eclipse.jgit:4.11.0.201803080745-r'
	compile 'com.diffplug.durian:durian-core:1.2.0'
	compile 'com.diffplug.durian:durian-collect:1.2.0'
	compile 'com.diffplug.durian:durian-io:1.2.0'
	testCompile "junit:junit:$JUNIT_VER"
	testCompile "org.assertj:assertj-core:$ASSERTJ_VER"
}

eclipse {
	project { referencedProjects = [ 'mytake-client'
		] } }

task generateFoundation(type: JavaExec) {
	description = 'Generates the foundation'
	classpath = sourceSets.main.runtimeClasspath
	main = 'org.mytake.foundation.Index'
}
generateFoundation.dependsOn(classes)
generateFoundation.outputs.file('../foundation/src/main/resources/foundation-index-hash.json')

apply plugin: 'com.diffplug.gradle.spotless'
spotless {
	java {
		licenseHeaderFile(rootProject.file('gradle/spotless.license.java'))
		importOrder()
		eclipse().configFile(rootProject.file('gradle/spotless.eclipseformat.xml'))
		removeUnusedImports()
	}
	format 'foundation', {
		target 'src/main/resources/**'
		replace('Always use simple apostrophe', "’", "'")
		//replace('Always use simple right quote', '”', '"')
		//replace('Always use simple left quote', '“', '"')
	}
}
